global:
  namespace: investify
  imagePullPolicy: Always

  labels:
    app.kubernetes.io/name: investify
    app.kubernetes.io/instance: investify
    app.kubernetes.io/part-of: investify-app
    app.kubernetes.io/managed-by: argocd

replicaCount: 1

# Container Images (Go API + Next.js Frontend)
image:
  api:
    repository: sangkips/investify-backend
    tag: latest
    pullPolicy: Always
  frontend:
    repository: sangkips/investify-frontend
    tag: latest
    pullPolicy: Always

# Service Configuration
service:
  api:
    type: ClusterIP
    port: 8080
  frontend:
    type: ClusterIP
    port: 3000

# Ingress Configuration (Traefik)
ingress:
  enabled: true
  className: "traefik"
  hosts:
  - host: investify.autoscaleops.com
    paths:
    - path: /
      pathType: Prefix
      service: frontend
  - host: backend.autoscaleops.com
    paths:
    - path: /
      pathType: Prefix
      service: api
  tls: true
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: web,websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    cert-manager.io/cluster-issuer: letsencrypt-prod

# Resource limits
resources:
  api:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  frontend:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"

# Go API environment variables
api:
  env:
    APP_ENV: "production"
    PORT: "8080"
    GIN_MODE: "release"

# Next.js Frontend environment variables
frontend:
  env:
    NODE_ENV: "production"
    NEXT_PUBLIC_API_URL: "https://backend.autoscaleops.com/api/v1"

# Health checks
healthCheck:
  api:
    path: "/health"
    port: 8080
  frontend:
    path: "/"
    port: 3000

# PostgreSQL Configuration
database:
  connection: "postgres"
  host: "" # Set via Vault secrets
  port: "5432"
  database: "postgres"
  username: "postgres"
  password: "" # Set via Vault secrets

# Prometheus Monitoring Configuration
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
    labels:
      prometheus: investify
    interval: 30s
    scrapeTimeout: 10s
    path: /metrics

# External Secrets Configuration (Vault)
externalSecrets:
  enabled: true
  refreshInterval: "5m"

  vault:
    server: "http://vault.vault.svc.cluster.local:8200"
    path: "secret"
    version: "v2"
    secretPath: "investify/production"
    tokenSecretName: "vault-token"
    tokenSecretNamespace: "vault"
